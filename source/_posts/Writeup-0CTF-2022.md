---
title: Writeup for 0CTF2022
date: 2022-8-04 09:25:00
author: ç¾é£Ÿå®¶æè€å­
img: https://laoba-1304292449.cos.ap-chengdu.myqcloud.com/img/20220918152934.png
top: false
hide: false
cover: false
coverImg: 
password: 
toc: true
mathjax: false
summary: CTF
categories: CTF
tags:
    - æ¯”èµ›
---
# Rev

## Baby Encoder----æœªå®Œæˆ

### è‡ªå·±

#### ä¸»é€»è¾‘

1. åˆ©ç”¨ `\dev\urandom`éšæœºç”Ÿæˆäº† `0x40` çš„éšæœºæ•°å­—ï¼Œå¹¶ä¸”å¯¹è¿™äº›éšæœºæ•°å­—è¿›è¡Œäº†çº¿æ€§å˜åŒ–ã€‚
   ![1](https://laoba-1304292449.cos.ap-chengdu.myqcloud.com/img/20220918153242.png)
2. åŸºäºbufä¸­å…«ä¸ªå­—èŠ‚ï¼Œè¿›è¡Œä¸€ç³»åˆ—è¿ç®—ï¼Œäº§ç”Ÿ `128`ä¸ªdoubleç±»å‹çš„æ•°æ®åˆ° `int_64 v6[1024]`ä¸­å»ã€‚
   ![2éƒ¨åˆ†å‡½æ•°](https://laoba-1304292449.cos.ap-chengdu.myqcloud.com/img/20220918153539.png)
3. æ‰“å°è¾“å‡º `v6`ä¸­çš„å†…å®¹ï¼Œå¹¶ä¸”ä»æ ‡å‡†è¾“å…¥ä¸­è¯»å– `64ä¸ªå­—èŠ‚`ï¼Œä¸ `bufå‰64ä¸ªå­—èŠ‚`è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœç›¸åŒåˆ™è¾“å‡ºflagã€‚

#### æƒ³æ³•

é€šè¿‡è§‚å¯Ÿå‘ç° `\dev\urandom`æ¯ä¸€æ¬¡äº§ç”Ÿçš„éšæœºæ•°éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½æ˜¯æ ¹æ®ç¨‹åºå›æ˜¾å‡ºæ¥çš„v6ä¸­çš„å†…å®¹åæ¨bufã€‚

åœ¨æ‰§è¡Œæƒ³æ³•çš„è¿‡ç¨‹ä¸­é‡åˆ°äº†é˜»ç¢ï¼Œåœ¨ä¸»é€»è¾‘çš„ç¬¬äºŒæ­¥ä¸­ï¼Œå‚ä¸è¿ç®—çš„éƒ¨åˆ†æ•°æ®åŒæ ·æ¥æºäº `\dev\urandom`ã€‚è¿™æ ·æˆ‘å°±æ²¡åŠæ³•é€šè¿‡ `v6çš„å†…å®¹`æ ¹æ®è¿ç®—è¿‡ç¨‹æ¨ç®—å‡ºå‚ä¸è¿ç®—çš„ `int_64 buf[j]--8ä¸ªå­—èŠ‚çš„å†…å®¹`ã€‚

```c
  v24 = (int)(3.141592653589793 / 64.0 * (double)((int)sub_55C6B1D5C365() % 255));
  v25 = (int)(3.141592653589793 / 64.0 * (double)((int)sub_55C6B1D5C365() % 255));
  v26 = (int)(3.141592653589793 / 64.0 * (double)((int)sub_55C6B1D5C365() % 255));
  v27 = (int)(3.141592653589793 / 64.0 * (double)((int)sub_55C6B1D5C365() % 255));
  v28 = (int)(3.141592653589793 / 64.0 * (double)((int)sub_55C6B1D5C365() % 255));
  v29 = (int)(3.141592653589793 / 64.0 * (double)((int)sub_55C6B1D5C365() % 255));
  v30 = (int)(3.141592653589793 / 64.0 * (double)((int)sub_55C6B1D5C365() % 255));
  v31 = (int)(3.141592653589793 / 64.0 * (double)((int)sub_55C6B1D5C365() % 255));

  result = (unsigned int)((int)sub_55C6B1D5C365() % 255);
  v32 = result;
  for ( i = 0; i <= 127; ++i )
  {
    v11 = cos((3.141592653589793 + 3.141592653589793) * 2000.0 * 0.00000390625 * (double)i + (double)v24) * (double)a2;
    v12 = cos(
            (2000.0 * (3.141592653589793 + 3.141592653589793) + 2000.0 * (3.141592653589793 + 3.141592653589793))
          * 0.00000390625
          * (double)i
          + (double)v25)
        * (double)a3
        + v11;
    v13 = cos((3.141592653589793 + 3.141592653589793) * 2000.0 * 3.0 * 0.00000390625 * (double)i + (double)v26)
        * (double)a4
        + v12;
    v14 = cos((3.141592653589793 + 3.141592653589793) * 2000.0 * 4.0 * 0.00000390625 * (double)i + (double)v27)
        * (double)a5
        + v13;
    v15 = cos((3.141592653589793 + 3.141592653589793) * 2000.0 * 5.0 * 0.00000390625 * (double)i + (double)v28)
        * (double)a6
        + v14;
    v16 = cos((3.141592653589793 + 3.141592653589793) * 2000.0 * 6.0 * 0.00000390625 * (double)i + (double)v29)
        * (double)a7
        + v15;
    v17 = cos((3.141592653589793 + 3.141592653589793) * 2000.0 * 7.0 * 0.00000390625 * (double)i + (double)v30)
        * (double)a8
        + v16;
    v18 = cos((3.141592653589793 + 3.141592653589793) * 2000.0 * 8.0 * 0.00000390625 * (double)i + (double)v31)
        * (double)a9
        + v17;
    v10 = v18 + (double)((int)sub_55C6B1D5C365() % 3);
    result = 8LL * i + a1;
    *(double *)result = (double)v32 + v10;
  }
```

ç„¶åæˆ‘æœ‰çŒœæµ‹ï¼Œæ˜¯å¦åœ¨ `coså‚ä¸çš„è¿ç®—`ä¸­å¯ä»¥æŠŠç›¸å…³çš„éšæœºå› ç´ ç»™æ¶ˆé™¤æ‰ã€‚è§‚å¯Ÿäº†å¾ˆé•¿æ—¶é—´ï¼Œä¹Ÿæ²¡å‘ç°å…¶ä¸­è•´å«çš„æ•°å­¦æ³•åˆ™å¯ä»¥æŠŠéšæœºçš„å› ç´ ç»™æ¶ˆé™¤æ‰ã€‚



### Writeup

å±…ç„¶æ¶‰åŠåˆ°æ•°å­¦çš„å‚…é‡Œå¶çº§æ•°ï¼Œè¿™çœŸçš„æ˜¯å®Œå…¨æ²¡æœ‰æƒ³åˆ°çš„ã€‚

å¤§ä½“æ€è·¯å°±æ˜¯é€šè¿‡å‚…é‡Œå¶çº§æ•°çš„ä¸åŒå½¢å¼ï¼Œå¿½ç•¥æ‰éšæœºçš„éƒ¨åˆ†ï¼Œåªæ±‚æŒ¯å¹…ã€‚æŒ¯å¹…å°±æ˜¯`buf[j]`ã€‚å’±æ˜¯å®åœ¨æ²¡è€å¿ƒçœ‹ç€ä¸€å †æ•°å­¦å…¬å¼ã€‚

[writeup](https://hackmd.io/@vishiswoz/rkSNRg8Zo#)

![writeupå›¾ç‰‡](https://laoba-1304292449.cos.ap-chengdu.myqcloud.com/img/20220920151256.png)

## vintage - part1---æœªå®Œæˆ

### è‡ªå·±

ç”¨linuxä¸‹çš„fileå·¥å…·åˆ†æäº†ä¸€ä¸‹ï¼Œæ˜¾ç¤ºå…¶æ˜¯ `Vectrex ROM image`ã€‚

![Vectrex ROM](https://laoba-1304292449.cos.ap-chengdu.myqcloud.com/img/20220918161455.png)

æˆ‘æ‰¾äº†å¾ˆé•¿æ—¶é—´çš„æ¨¡æ‹Ÿå™¨ï¼Œæƒ³è¦æ‰¾ä¸€ä¸ªæ¨¡æ‹Ÿå™¨æ¨¡æ‹Ÿè¿è¡Œè¿™ä¸ªé•œåƒæ–‡ä»¶ã€‚æ‰¾äº†åŠå¤©ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªåœ¨çº¿ç‰ˆæœ¬çš„ã€‚æŠŠè¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ç›´æ¥æ‹–è¿›å»å°±å¯ä»¥è¿è¡Œã€‚

[https://drsnuggles.github.io/jsvecx/](https://drsnuggles.github.io/jsvecx/)

![è¿è¡Œç»“æœ](https://laoba-1304292449.cos.ap-chengdu.myqcloud.com/img/20220918173202.png)

æ³¥é©¬8ä½å¯†ç ï¼Œå¤§å†™å­—æ¯+æ•°å­—+ç¬¦å·ã€‚å‘œå‘œå‘œï¼Œç„¶åæˆ‘è¯•ç€åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ‰¾äº†ä¸€ä¸‹å­—ç¬¦ä¸²ï¼Œå¦‚æœæ¸¸æˆå¯†ç æ˜¯æ˜æ–‡å­˜æ”¾çš„è¯ï¼Œåº”è¯¥æ˜¯å¯ä»¥æ‰¾åˆ°çš„ã€‚

ç»“æœå°±æ˜¯æ²¡æ‰¾ç€ã€‚ã€‚ã€‚ã€‚

æˆ‘åˆæƒ³ç€æ ¹æ®è¿™ä¸ªgameçš„æ–‡ä»¶æ ¼å¼---é€šè¿‡å¯¹æ¯”ç½‘ä¸Šçš„è¿™ç§æ¸¸æˆå‘ç°å®ƒä»¬éƒ½æ˜¯ `.vecç»“å°¾çš„`å»é€†æ¨æºç ã€‚åœ¨ç½‘ä¸Šæœäº†åŠå¤©ä¹Ÿæ²¡å‘ç°ç›¸å…³ã€‚çœŸæ˜¯æ— è¯­~~~

:> :> :> :>

æœ€ç»ˆæ‰¾åˆ°äº†ä¸€ä¸ªvectrexyå·¥å…·é“¾æ¥å¦‚ä¸‹ï¼Œå€’æ˜¯å¯ä»¥è°ƒè¯•äº†ï¼Œä½†æ˜¯è¿™é‡Œé¢ä»£ç å•¥çš„çœ‹ä¸æ‡‚å‘¢ï¼

[https://github.com/amaiorano/vectrexy](https://github.com/amaiorano/vectrexy)

![vectrexy](https://laoba-1304292449.cos.ap-chengdu.myqcloud.com/img/20220919100935.png)

### writeup

## æ€»ç»“

ğŸ˜”ğŸ˜”ğŸ˜”ğŸ˜”